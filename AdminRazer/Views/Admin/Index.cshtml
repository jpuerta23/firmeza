@model AdminRazer.ViewModels.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard Administrador";
    Layout = "_AdminLayout";
}

<div class="dashboard-container">
    <!-- Welcome Banner -->
    <div class="welcome-banner mb-4">
        <div class="welcome-content">
            <h2 class="welcome-title">
                <i class="bi bi-shop me-2"></i>Bienvenido a Firmeza Store
            </h2>
            <p class="welcome-subtitle">Panel de Administraci√≥n</p>
        </div>
        <div class="welcome-user">
            <i class="bi bi-person-circle me-2"></i>
            <span>@User.Identity?.Name</span>
        </div>
    </div>

    <h1 class="dashboard-title text-center mb-5">Dashboard Administrador</h1>

    <div class="row g-4">
        <!-- Clientes Card -->
        <div class="col-md-6">
            <div class="metric-card">
                <div class="metric-header">
                    <h5 class="metric-title">Clientes</h5>
                </div>
                <div class="metric-content">
                    <div class="metric-value">@Model.ClientsCount.ToString("N0")</div>
                    <div class="chart-container">
                        <canvas id="clientsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Productos Card -->
        <div class="col-md-6">
            <div class="metric-card">
                <div class="metric-header">
                    <h5 class="metric-title">Productos</h5>
                </div>
                <div class="metric-content">
                    <div class="metric-value">@Model.ProductsCount.ToString("N0")</div>
                    <div class="chart-container">
                        <canvas id="productsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ventas Card -->
        <div class="col-md-12">
            <div class="metric-card">
                <div class="metric-header">
                    <h5 class="metric-title">Ventas</h5>
                </div>
                <div class="metric-content">
                    <div class="metric-value">$@Model.SalesTotalToday.ToString("N0")</div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Clientes Chart
        new Chart(document.getElementById('clientsChart'), {
            type: 'line',
            data: {
                labels: ['', '', '', '', '', '', ''],
                datasets: [{
                    data: [180, 200, 190, 220, 210, 240, @Model.ClientsCount],
                    borderColor: '#4e73df',
                    backgroundColor: 'rgba(78, 115, 223, 0.1)',
                    fill: true,
                    borderWidth: 2
                }]
            },
            options: {
                animation: false,
                plugins: { legend: { display: false } },
                scales: { 
                    x: { display: false }, 
                    y: { display: false } 
                },
                elements: { 
                    line: { tension: 0.4 }, 
                    point: { radius: 0 } 
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Productos Chart
        new Chart(document.getElementById('productsChart'), {
            type: 'line',
            data: {
                labels: ['', '', '', '', '', '', ''],
                datasets: [{
                    data: [800, 850, 900, 920, 950, 1000, @Model.ProductsCount],
                    borderColor: '#1cc88a',
                    backgroundColor: 'rgba(28, 200, 138, 0.1)',
                    fill: true,
                    borderWidth: 2
                }]
            },
            options: {
                animation: false,
                plugins: { legend: { display: false } },
                scales: { 
                    x: { display: false }, 
                    y: { display: false } 
                },
                elements: { 
                    line: { tension: 0.4 }, 
                    point: { radius: 0 } 
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Ventas Chart
        const salesData = @Html.Raw(Json.Serialize(Model.SalesHistory));
        const salesLabels = @Html.Raw(Json.Serialize(Model.SalesDates));

        new Chart(document.getElementById('salesChart'), {
            type: 'bar',
            data: {
                labels: salesLabels.length > 0 ? salesLabels : ['', '', '', ''],
                datasets: [{
                    data: salesData.length > 0 ? salesData : [18000, 22000, 24000, 25340],
                    backgroundColor: '#ff6b6b',
                    borderRadius: 4,
                    barThickness: 40
                }]
            },
            options: {
                animation: false,
                plugins: { legend: { display: false } },
                scales: { 
                    x: { display: false }, 
                    y: { display: false } 
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });
    </script>
}
